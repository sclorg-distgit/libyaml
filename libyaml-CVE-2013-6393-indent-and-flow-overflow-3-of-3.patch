# HG changeset patch
# User Kirill Simonov <xi@resolvent.net>
# Date 1391409843 21600
#      Mon Feb 03 00:44:03 2014 -0600
# Node ID af3599437a87162554787c52d8b16eab553f537b
# Parent  0df2fb962294f3a6df1450a3e08c6a0f74f9078c
Forgot to set the error state.

diff -r 0df2fb962294 -r af3599437a87 src/scanner.c
--- a/src/scanner.c	Mon Feb 03 00:26:46 2014 -0600
+++ b/src/scanner.c	Mon Feb 03 00:44:03 2014 -0600
@@ -1176,8 +1176,10 @@
 
     /* Increase the flow level. */
 
-    if (parser->flow_level == INT_MAX)
+    if (parser->flow_level == INT_MAX) {
+        parser->error = YAML_MEMORY_ERROR;
         return 0;
+    }
 
     parser->flow_level++;
 
@@ -1229,8 +1231,10 @@
         if (!PUSH(parser, parser->indents, parser->indent))
             return 0;
 
-        if (column > INT_MAX)
+        if (column > INT_MAX) {
+            parser->error = YAML_MEMORY_ERROR;
             return 0;
+        }
 
         parser->indent = column;
 
